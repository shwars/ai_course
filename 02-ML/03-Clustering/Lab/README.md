## Лабораторная работа
## Кластеризация банковских клиентов

В данной работе мы рассмотрим тот же [датасет банковских пользователей](https://www.kaggle.com/datasets/sakshigoyal7/credit-card-customers), что и в предыдущей лабораторной. Слегка очищенная версия датасета [содержится в материалах к курсу](../../../data/BankChurnersProcessed.csv).

Датасет имеет следующие поля:

Поле | Значение
-----|---------
CLIENTNUM | Уникальные идентификатор клиента
Attrition_Flag | Признак того, что клиент покинул банк
Customer_Age | Возраст
Gender | Пол
Dependent_count | Число зависимых членов семьи
Education_Level | Уровень образования
Marital_Status | Семейный статус
Income_Category | Уровень годового дохода
Card_Category | Тип кредитной карты
Months_on_book | Время сотрудничества с банком (мес)
Total_Relationship_Count | Общее число продуктов у клиента
Months_Inactive_12_mon | Число неактивных месяцев за последний год
Contacts_Count_12_mon | Число контактов за последний год
Credit_Limit | Кредитный лимит на карте
Total_Revolving_Bal | Общий активный баланс на карте
Avg_Open_To_Buy | Разница между кредитным лимитом по карте и текущим балансом, среднее за последний год 
Total_Amt_Chng_Q4_Q1 | Изменение суммы транзакций за год (Q4 на Q1)
Total_Trans_Amt | Сумма транзакций за год
Total_Trans_Ct | Общее число транзакций за год
Total_Ct_Chng_Q4_Q1 | Изменение количества транзакций за год (Q4 на Q1)
Avg_Utilization_Ratio | Объем средств клиента делённый на кредитный лимит (в %)

Требуется выделить основные кластеры клиентов и посмотреть, насколько они соответствуют показателям оттока.

Основные этапы работы:

**Предварительная обработка данных**

Поскольку кластеризация оценивает близость точек по евклидовой метрике, нам особенно полезно, чтобы большинство категориальных признаков были порядковыми.

> Посмотрите на все категориальные признаки. Есть ли среди них такие, которые не могут быть закодированы как порядковые?

* В некоторых признаках присутствуют значения `Unknown`. Для данной работы предлагается удалить соответствующие строки и рассматривать только тех клиентов, для которых все значения признаков известны.
* Преобразуйте все категориальные признаки в числа как порядковые признаки. Для этого можно использовать `LabelEncoder` из Scikit Learn, либо сделать это вручную. Но необходимо учитывать, что важно соблюдать порядок значений в соответствии со здравым смыслом (например, уровни образования важно располагать в порядке `Uneducated`, `High School`, `College`, `Graduate`, `Post-Graduate`, `Doctorate`).
* Используйте `StandardScaler` или `MinMaxScaler` для приведения всех признаков к одному диапазону

> Для кластеризации не используйте поле `Attrition_Flag`, поскольку мы хотим посмотреть на кластеры клиентов безотносительно к их решению покинуть банк.

**Визуализация данных**

* Используйте метод главных компонент для визуализации клиентов на плоскости. Используйте `Attrition_Flag` и покажите оттекающих и не оттекающих клиентов разным цветом. Заметно ли визуально расположение двух классов на плоскости?
* Сколько основных классов можно выделить визуально?

**Кластеризация**

* Используйте метод K-Means для разбиения множества клиентов на соответствующее число кластеров (в соответствии с выводом из прошлого пункта).
* Преобразуйте центроиды каждого из кластеров к исходным значениям признаков (используя `inverse_transform`), и проинтерпретируйте каждый из кластеров в соответствии с этими признаками.
* Сделайте перебор количества кластеров, и по графику инерции определите, какое число кластеров было бы оптимальным
* Отметьте полученные кластеры на визуализации из прошлого пункта и посмотрите, насколько кластеры визуально соотносятся с признаком оттока клиентов.

